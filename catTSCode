#!/usr/bin/env bash

# Check if any arguments were provided
if [ $# -eq 0 ]; then
    echo "Usage: $0 dir1 [dir2 ...]"
    echo "Please provide at least one directory path"
    exit 1
fi

# Output file
OUTPUT="merged.ts"

# Remove the output file if it already exists
rm -f "$OUTPUT"

# Process each directory provided as an argument
for dir in "$@"; do
    if [ ! -d "$dir" ]; then
        echo "Warning: $dir is not a directory, skipping..."
        continue
    fi
    
    # Use find to get all .ts files recursively
    while IFS= read -r -d '' file; do
        echo "// $file" >> "$OUTPUT"
        cat "$file" >> "$OUTPUT"
        echo "" >> "$OUTPUT"
    done < <(find "$dir" -type f -name "*.ts" -print0)
done

echo "All files merged into $OUTPUT"
